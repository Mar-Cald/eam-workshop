{"title":"","markdown":{"yaml":{"title":" "},"headingText":"Bayesian Inference","containsRefs":false,"markdown":"\n\n```{r}\n#| echo: false\n#| message: false\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n\n\n**Data are fixed**, but **parameters are uncertain**.\n\n<br/>\n\n$$\np(\\boldsymbol{\\theta}|\\boldsymbol{D}) = \\frac{p(\\boldsymbol{D}|\\boldsymbol{\\theta})p(\\boldsymbol{\\theta})}{p({\\boldsymbol D})}\n$$\n<br/>\n\n- Inference produces **posterior distributions** over parameters  \n\n- Captures uncertainty and incorporates prior knowledge  \n\n\n## Hierarchical Modeling {.align-center}\n\n*Are participants identical or fully independent?*\n\n:::: {.columns}\n::: {.column width=\"45%\"}\n\nModels **group-level structure**\n\neach participant’s parameters ∼ drawn from a population distribution\n<br/><br/>\n\n**Group-level** generalization\n<br/>\n\n**Individual-level** inference  \n<br/>\n\n:::\n\n::: {.column width=\"55%\"}\n\n\n```{r}\n#| echo: false\n#| fig-width: 8\n#| fig-asp: .7\n#| message: false\n#| warning: false\n\n# Function to create a normal distribution curve\nnormal_curve <- function(mean, sd, n = 200, range_mult = 3) {\n  x <- seq(mean - range_mult*sd, mean + range_mult*sd, length.out = n)\n  y <- dnorm(x, mean, sd)\n  data.frame(x = x, y = y)\n}\n\n# Create data for the plots\nhyper_curve <- normal_curve(0.5, 0.05)\nindividual_curves <- rbind(\n  normal_curve(0.35, 0.06) %>% mutate(subj = \"1\"),\n  normal_curve(0.5, 0.03) %>% mutate(subj = \"2\"),\n  normal_curve(0.7, 0.04) %>% mutate(subj = \"3\")\n)\n\n# Normalize y values\nmax_y <- max(c(hyper_curve$y, individual_curves$y))\nhyper_curve$y <- hyper_curve$y / max_y\nindividual_curves$y <- individual_curves$y / max_y\n\n# Create the main plot\np1 <- ggplot() +\n  # Hyper-distribution curve\n  geom_line(data = hyper_curve, aes(x, y + 1.6), size = 2.5, color = \"black\") +\n  # Individual curves\n  geom_line(data = individual_curves, aes(x, y - .1, \n                                          group = subj, color = subj,\n                                          fill = subj), \n            size = 2.5, show.legend = FALSE) +  # X marks\n  geom_point(aes(x = c(0.38, 0.5, 0.65), y = rep(1.12, 3)), \n             shape = 21, size = 8, fill = c(\"cyan4\", \"green2\", \"purple2\")) +\n  # Labels\n  annotate(\"text\", x = 0.5, y = 1.8, label = \"μ,σ\", color = \"red\", size = 10) +\n  # Customize the plot\n  theme_void() +\n  coord_cartesian(xlim = c(0.1, 0.9), ylim = c(-0.2, 2.3), expand = FALSE) +\n  # Add arrows top-down\n  geom_segment(aes(x = 0.45, y = 1.6, xend = 0.39, yend = 1.2), size = 1.5,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  geom_segment(aes(x = 0.5, y = 1.6, xend = 0.5, yend = 1.2), size = 1.5,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  geom_segment(aes(x = 0.55, y = 1.6, xend = 0.64, yend = 1.2), size = 1.5,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  # Add arrows bottom-up\n  geom_segment(aes(x = 0.35, y = 0.7, xend = 0.37, yend = 1.02), size = 1,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  geom_segment(aes(x = 0.5, y = 0.95, xend = 0.5, yend = 1.02), size = 1,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  geom_segment(aes(x = 0.69, y = 0.8, xend = 0.66, yend = 1.02), size = 1,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  scale_color_manual(values = c(\"1\" = \"cyan4\", \"2\" = \"green2\", \"3\" = \"purple2\"))+\n  geom_point(aes(x = c(0.35, 0.5, 0.7), y = rep(-0.1, 3)), \n             shape = 21, size = 8, fill = c(\"cyan4\", \"green2\", \"purple2\"))\n\n\n# Display the plot\nprint(p1)\n\n\n```\n:::\n:::::\n\n\n## Why Hierarchical Models?\n\n-   Reduces bias from unmodeled individual variability  \n-   Prevents overfitting *and* underfitting  \n-   **Shrinkage**: pulls extreme or low-quality estimates toward the group mean  \n\n> [Boehm et al. (2018), *Behavior Research Methods*](https://doi.org/10.3758/s13428-018-1054-3)\n\n\n\n## What Are We Trying to Infer?\n\nWe want to estimate:\n\n- **Individual-level parameters**:  $\\alpha_1, \\alpha_2, \\dots, \\alpha_N$\n\n\n- **Group-level structure**:  \n  A shared population distribution  $\\alpha_i \\sim \\mathcal{N}(\\mu, \\Sigma)$\n\nThis enables both **individual** and **population** inference.\n\n\n## Model Structure\n\nThe hierarchical model defines a **joint posterior** over all unknowns:\n\n$$\np(\\alpha_i, \\mu, \\Sigma \\mid \\text{data}) \\propto \np(\\text{data} \\mid \\alpha_i) \\cdot \np(\\alpha_i \\mid \\mu, \\Sigma) \\cdot \np(\\mu, \\Sigma)\n$$\n\n- **Likelihood**:  \n  $p(\\text{data} \\mid \\alpha_i)$  \n  — How well each participant's data is explained by their parameters\n\n- **Group-level model**:  \n  $p(\\alpha_i \\mid \\mu, \\Sigma)$  — Individual parameters drawn from population distribution\n\n- **Hyperprior**:  \n  $p(\\mu, \\Sigma)$  — Prior beliefs over the group-level structure\n\n\n## Group-Level Parameters\n\nLet $n$ = number of individual parameters per subject:\n\n- $\\mu$: vector of **population means**  \n- $\\Sigma$: symmetric **covariance matrix**, including:\n\n  - Diagonal: **Variances** ($\\sigma^2$)\n  - Off-diagonal: **Covariances**  \n    $\\frac{n(n-1)}{2}$ elements total\n\nThese hyperparameters are **learned from the data**.\n\n## Priors\n\nCognitive-model parameters must be transformed to have support on the real line. This transformation is necessary to meet the assumption of the normal group-level distribution. \n\n-   **Log** transform: Applied to parameters with a lower bound (e.g., non-decision time, which cannot be negative)\n-   **Probit** transform: Applied to parameters with both lower and upper bounds (e.g., the starting point parameter in the Drift Diffusion Model, which must lie between two response boundaries)\n\nAs a result, priors are specified on these transformed parameters rather than on the original scales.\n\n## Set up - EMC2\n\n```{r, echo=TRUE}\n# # If not already done, install the EMC2 package\n# remotes::install_github(\"ampl-psych/EMC2\",ref=\"dev\")\nlibrary(EMC2)\n```\n\n## Design specification\n\nThe design function creates a design object that maps model parameters to experimental conditions using linear model formulas. This object specifies:\n\n1.  Model type\n2.  Linear models for estimated parameter types (default values are used for omitted types)\n3.  Parameters to be fixed as constants (optional)\n4.  Functions for creating custom factors (optional)\n5.  Custom contrast coding for factors (optional)\n\n\nThe simulation procedure\n\n","srcMarkdownNoYaml":"\n\n```{r}\n#| echo: false\n#| message: false\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n\n## Bayesian Inference\n\n**Data are fixed**, but **parameters are uncertain**.\n\n<br/>\n\n$$\np(\\boldsymbol{\\theta}|\\boldsymbol{D}) = \\frac{p(\\boldsymbol{D}|\\boldsymbol{\\theta})p(\\boldsymbol{\\theta})}{p({\\boldsymbol D})}\n$$\n<br/>\n\n- Inference produces **posterior distributions** over parameters  \n\n- Captures uncertainty and incorporates prior knowledge  \n\n\n## Hierarchical Modeling {.align-center}\n\n*Are participants identical or fully independent?*\n\n:::: {.columns}\n::: {.column width=\"45%\"}\n\nModels **group-level structure**\n\neach participant’s parameters ∼ drawn from a population distribution\n<br/><br/>\n\n**Group-level** generalization\n<br/>\n\n**Individual-level** inference  \n<br/>\n\n:::\n\n::: {.column width=\"55%\"}\n\n\n```{r}\n#| echo: false\n#| fig-width: 8\n#| fig-asp: .7\n#| message: false\n#| warning: false\n\n# Function to create a normal distribution curve\nnormal_curve <- function(mean, sd, n = 200, range_mult = 3) {\n  x <- seq(mean - range_mult*sd, mean + range_mult*sd, length.out = n)\n  y <- dnorm(x, mean, sd)\n  data.frame(x = x, y = y)\n}\n\n# Create data for the plots\nhyper_curve <- normal_curve(0.5, 0.05)\nindividual_curves <- rbind(\n  normal_curve(0.35, 0.06) %>% mutate(subj = \"1\"),\n  normal_curve(0.5, 0.03) %>% mutate(subj = \"2\"),\n  normal_curve(0.7, 0.04) %>% mutate(subj = \"3\")\n)\n\n# Normalize y values\nmax_y <- max(c(hyper_curve$y, individual_curves$y))\nhyper_curve$y <- hyper_curve$y / max_y\nindividual_curves$y <- individual_curves$y / max_y\n\n# Create the main plot\np1 <- ggplot() +\n  # Hyper-distribution curve\n  geom_line(data = hyper_curve, aes(x, y + 1.6), size = 2.5, color = \"black\") +\n  # Individual curves\n  geom_line(data = individual_curves, aes(x, y - .1, \n                                          group = subj, color = subj,\n                                          fill = subj), \n            size = 2.5, show.legend = FALSE) +  # X marks\n  geom_point(aes(x = c(0.38, 0.5, 0.65), y = rep(1.12, 3)), \n             shape = 21, size = 8, fill = c(\"cyan4\", \"green2\", \"purple2\")) +\n  # Labels\n  annotate(\"text\", x = 0.5, y = 1.8, label = \"μ,σ\", color = \"red\", size = 10) +\n  # Customize the plot\n  theme_void() +\n  coord_cartesian(xlim = c(0.1, 0.9), ylim = c(-0.2, 2.3), expand = FALSE) +\n  # Add arrows top-down\n  geom_segment(aes(x = 0.45, y = 1.6, xend = 0.39, yend = 1.2), size = 1.5,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  geom_segment(aes(x = 0.5, y = 1.6, xend = 0.5, yend = 1.2), size = 1.5,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  geom_segment(aes(x = 0.55, y = 1.6, xend = 0.64, yend = 1.2), size = 1.5,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  # Add arrows bottom-up\n  geom_segment(aes(x = 0.35, y = 0.7, xend = 0.37, yend = 1.02), size = 1,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  geom_segment(aes(x = 0.5, y = 0.95, xend = 0.5, yend = 1.02), size = 1,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  geom_segment(aes(x = 0.69, y = 0.8, xend = 0.66, yend = 1.02), size = 1,\n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"gray50\") +\n  scale_color_manual(values = c(\"1\" = \"cyan4\", \"2\" = \"green2\", \"3\" = \"purple2\"))+\n  geom_point(aes(x = c(0.35, 0.5, 0.7), y = rep(-0.1, 3)), \n             shape = 21, size = 8, fill = c(\"cyan4\", \"green2\", \"purple2\"))\n\n\n# Display the plot\nprint(p1)\n\n\n```\n:::\n:::::\n\n\n## Why Hierarchical Models?\n\n-   Reduces bias from unmodeled individual variability  \n-   Prevents overfitting *and* underfitting  \n-   **Shrinkage**: pulls extreme or low-quality estimates toward the group mean  \n\n> [Boehm et al. (2018), *Behavior Research Methods*](https://doi.org/10.3758/s13428-018-1054-3)\n\n\n\n## What Are We Trying to Infer?\n\nWe want to estimate:\n\n- **Individual-level parameters**:  $\\alpha_1, \\alpha_2, \\dots, \\alpha_N$\n\n\n- **Group-level structure**:  \n  A shared population distribution  $\\alpha_i \\sim \\mathcal{N}(\\mu, \\Sigma)$\n\nThis enables both **individual** and **population** inference.\n\n\n## Model Structure\n\nThe hierarchical model defines a **joint posterior** over all unknowns:\n\n$$\np(\\alpha_i, \\mu, \\Sigma \\mid \\text{data}) \\propto \np(\\text{data} \\mid \\alpha_i) \\cdot \np(\\alpha_i \\mid \\mu, \\Sigma) \\cdot \np(\\mu, \\Sigma)\n$$\n\n- **Likelihood**:  \n  $p(\\text{data} \\mid \\alpha_i)$  \n  — How well each participant's data is explained by their parameters\n\n- **Group-level model**:  \n  $p(\\alpha_i \\mid \\mu, \\Sigma)$  — Individual parameters drawn from population distribution\n\n- **Hyperprior**:  \n  $p(\\mu, \\Sigma)$  — Prior beliefs over the group-level structure\n\n\n## Group-Level Parameters\n\nLet $n$ = number of individual parameters per subject:\n\n- $\\mu$: vector of **population means**  \n- $\\Sigma$: symmetric **covariance matrix**, including:\n\n  - Diagonal: **Variances** ($\\sigma^2$)\n  - Off-diagonal: **Covariances**  \n    $\\frac{n(n-1)}{2}$ elements total\n\nThese hyperparameters are **learned from the data**.\n\n## Priors\n\nCognitive-model parameters must be transformed to have support on the real line. This transformation is necessary to meet the assumption of the normal group-level distribution. \n\n-   **Log** transform: Applied to parameters with a lower bound (e.g., non-decision time, which cannot be negative)\n-   **Probit** transform: Applied to parameters with both lower and upper bounds (e.g., the starting point parameter in the Drift Diffusion Model, which must lie between two response boundaries)\n\nAs a result, priors are specified on these transformed parameters rather than on the original scales.\n\n## Set up - EMC2\n\n```{r, echo=TRUE}\n# # If not already done, install the EMC2 package\n# remotes::install_github(\"ampl-psych/EMC2\",ref=\"dev\")\nlibrary(EMC2)\n```\n\n## Design specification\n\nThe design function creates a design object that maps model parameters to experimental conditions using linear model formulas. This object specifies:\n\n1.  Model type\n2.  Linear models for estimated parameter types (default values are used for omitted types)\n3.  Parameters to be fixed as constants (optional)\n4.  Functions for creating custom factors (optional)\n5.  Custom contrast coding for factors (optional)\n\n\nThe simulation procedure\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"eam-workshop.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":"cosmo","fontsize":"1.2em","linestretch":1.7,"mainfont":"Helvetica Neue","title":" "},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}